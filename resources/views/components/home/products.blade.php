@php
	$products = [
	    [
	        'name' => 'Populer',
	        'content' => [
	            ['name' => 'Issabel 2 Drawer Nightstand', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Bellz 20 Armchair', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => false, 'isHot' => true],
	            ['name' => 'Huron 26" Table Lamp', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 0, 'isSale' => false, 'isHot' => false],
	            ['name' => 'Elegant Dining Table', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Comfy Sofa Set', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Modern Bookshelf', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Luxury Bed Frame', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	        ],
	    ],
	    [
	        'name' => 'Terbaru',
	        'content' => [
	            ['name' => 'Issabel 2 Drawer Nightstand', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Bellz 20 Armchair', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => false, 'isHot' => true],
	            ['name' => 'Huron 26" Table Lamp', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 0, 'isSale' => false, 'isHot' => false],
	            ['name' => 'Elegant Dining Table', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Comfy Sofa Set', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Modern Bookshelf', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Luxury Bed Frame', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	        ],
	    ],
	    [
	        'name' => 'Diskon',
	        'content' => [
	            ['name' => 'Issabel 2 Drawer Nightstand', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Bellz 20 Armchair', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => false, 'isHot' => true],
	            ['name' => 'Huron 26" Table Lamp', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 0, 'isSale' => false, 'isHot' => false],
	            ['name' => 'Elegant Dining Table', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Comfy Sofa Set', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Modern Bookshelf', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Luxury Bed Frame', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	        ],
	    ],
	    [
	        'name' => 'Terlaris',
	        'content' => [
	            ['name' => 'Issabel 2 Drawer Nightstand', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Bellz 20 Armchair', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => false, 'isHot' => true],
	            ['name' => 'Huron 26" Table Lamp', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 0, 'isSale' => false, 'isHot' => false],
	            ['name' => 'Elegant Dining Table', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Comfy Sofa Set', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Modern Bookshelf', 'image' => 'https://via.placeholder.com/150', 'price' => 200000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	            ['name' => 'Luxury Bed Frame', 'image' => 'https://via.placeholder.com/150', 'price' => 100000, 'discount' => 10, 'isSale' => true, 'isHot' => true],
	        ],
	    ],
	];
	
	setlocale(LC_MONETARY, 'id_ID');
	$fmt = new NumberFormatter('id_ID', NumberFormatter::CURRENCY);
@endphp

<div class="w-full flex flex-col gap-10 py-32">
	<div class="flex w-full items-center justify-between px-14">
		<h2 class="text-xl font-bold red-decoration">Produk Kami</h2>
		<ul class="flex items-center relative">
			{{-- add index --}}
			@foreach ($products as $index => $product)
				<li class="w-16" id="tabNavigations">
					<input class="tab-controller peer" id="active-{{ $index }}" name="activeTab" type="radio"
						{{ $index == 0 ? 'checked' : '' }} hidden>
					<label
						class="text-xs font-medium cursor-pointer text-gray-400 hover:text-black peer-checked:text-red-500 smooth-transition"
						for="active-{{ $index }}">{{ $product['name'] }}</label>
				</li>
			@endforeach
			<div class="w-8 h-default bg-red-500 absolute bottom-0 smooth-transition" id="tabIndicator"></div>
		</ul>
	</div>
	<div>
		<div class="flex flex-col h-60 xl:h-80 overflow-hidden relative carousel-container">
			<span class="prev btn btn-ghost absolute top-1/2 left-0 -translate-y-1/2 z-50">
				<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
					stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
				</svg>
			</span>
			@foreach ($products as $index => $product)
				<div class="products-carousel _carousel masked-lr h-full full w-full smooth-transition relative shrink-0 ">
					<div class="flex h-full items-center justify-center slider overflow-visible smooth-transition">
						@foreach ($product['content'] as $productContent)
							<a
								class="carousel_contents flex w-1/5 flex-col gap-2 items-center relative justify-center h-full carousel-item box-border px-2"
								href="#" style="box-sizing: border-box">
								<div class="w-full grow">
									<img class="w-full object-cover" src="{{ $productContent['image'] }}" alt="">
								</div>
								<div class="h-20 text-center">
									<h3 class="text-xs xl:text-lg font-bold">{{ $productContent['name'] }}</h3>
									<p class="text-xs text-red-500">
										@if ($productContent['discount'] > 0)
											<s class="text-gray-400 text-xxs">
												{{ $fmt->formatCurrency($productContent['price'], 'IDR') }}
											</s>
											<span class="font-bold">
												{{ $fmt->formatCurrency(
												    $productContent['price'] - ($productContent['price'] * $productContent['discount']) / 100,
												    'IDR',
												) }}
											</span>
										@else
											<span class="font-bold">
												{{ $fmt->formatCurrency($productContent['price'], 'IDR') }}
										@endif
									</p>
								</div>

								<div class="absolute text-center uppercase text-us top-2 left-4 flex flex-col gap-1">
									@if ($productContent['isSale'])
										<span class="bg-pink-500 text-white rounded-sm px-2">Sale</span>
									@endif

									@if ($productContent['isHot'])
										<span class="bg-pink-800 text-white rounded-sm px-2">Hot</span>
									@endif

								</div>
							</a>
						@endforeach
					</div>

				</div>
			@endforeach
			<span class="next btn btn-ghost absolute top-1/2 right-0 -translate-y-1/2 z-50">
				<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
					stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
				</svg>
			</span>
		</div>
	</div>
</div>

<script>
	const tabControllers = document.querySelectorAll('.tab-controller');
	const tabIndicator = document.getElementById('tabIndicator');
	const productsCarousel = document.querySelectorAll('.products-carousel');

	tabControllers.forEach((tabController, index) => {
		let elementWidth = document.querySelector('#tabNavigations').offsetWidth;
		console.log(elementWidth)
		tabController.addEventListener('change', () => {
			tabIndicator.style.transform = `translateX(${index * elementWidth}px)`;

			productsCarousel.forEach((productCarousel, productIndex) => {
				productCarousel.style.transform = `translateY(-${index * 100}%)`;
			});
		});
	});


	const slider = document.querySelectorAll('.slider');
	const carousel = document.querySelectorAll('._carousel');
	const carouselContents = document.querySelectorAll('.carousel_contents');

	const prev = document.querySelector('.prev');
	const next = document.querySelector('.next');


	let direction;
	let elementWidth = carouselContents[0].clientWidth;

	window.addEventListener("resize", e => elementWidth = carouselContents[0].clientWidth)

	prev.addEventListener('click', function() {
		if (direction === -1) {
			slider.forEach((slider) => {
				slider.appendChild(slider.firstElementChild);
			})
			direction = 1;
		}
		carousel.forEach((carousel) => {
			carousel.style.justifyContent = 'flex-end';
		})
		slider.forEach((slider) => {
			slider.style.transform = `translate(${elementWidth}px)`;
		})
	});

	next.addEventListener('click', function() {
		direction = -1;
		carousel.forEach((carousel) => {
			carousel.style.justifyContent = 'flex-start';
		})
		slider.forEach((slider) => {
			slider.style.transform = `translate(-${elementWidth}px)`;
		})
	});


	slider.forEach(el => {
		el.addEventListener('transitionend', () => {
			if (direction === -1) {
				el.appendChild(el.firstElementChild);
			} else if (direction === 1) {
				el.prepend(el.lastElementChild);
			}
			el.style.transition = 'none';
			el.style.transform = 'translate(0)';
			setTimeout(() => {
				el.style.transition = 'all 0.5s';
			})
		})
	})
</script>
